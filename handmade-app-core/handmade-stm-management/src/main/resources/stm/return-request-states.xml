<?xml version="1.0" encoding="UTF-8"?>
<!--
ReturnRequest State Machine
Purpose: Manage the lifecycle of ReturnRequest entities
Flow: RETURN_REQUEST_FLOW
-->
<states>
    <event-information eventId='approve_return' 
                       eventName='Approve return' 
                       meta-acls="user.normal,user.admin"/>
    <event-information eventId='process_refund' 
                       eventName='Process refund' 
                       meta-acls="user.normal,user.admin"/>
    <event-information eventId='receive_item' 
                       eventName='Receive item' 
                       meta-acls="user.normal,user.admin"/>
    <event-information eventId='reject_return' 
                       eventName='Reject return' 
                       meta-acls="user.normal,user.admin"/>

    <flow id="RETURN_REQUEST_FLOW" default="true">
        <manual-state id="REQUESTED" initialState="true">
            <on eventId="approve_return" newStateId="APPROVED" componentName="returnApproveAction"/>
            <on eventId="reject_return" newStateId="REJECTED" componentName="returnRejectAction"/>
        </manual-state>
        <manual-state id="APPROVED">
            <on eventId="receive_item" newStateId="RECEIVED" componentName="returnReceiveAction"/>
        </manual-state>
        <manual-state id="RECEIVED">
            <on eventId="process_refund" newStateId="REFUNDED" componentName="returnRefundAction"/>
        </manual-state>
        <manual-state id="REFUNDED" meta-endState="true">

        </manual-state>
        <manual-state id="REJECTED" meta-endState="true">

        </manual-state>

    </flow>
</states>
