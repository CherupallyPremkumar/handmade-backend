@startuml
title Seller Onboarding Orchestration Flow

actor "Frontend Client" as Client
participant "API Gateway" as API
box "Seller Orchestration" #LightBlue
    participant "Orchestration Engine\n(Chenile)" as Orch
    participant "ValidateSellerService" as Validate
    participant "CreateSellerCommandService" as Create
    participant "VerifyKycService" as KYC
    participant "SendWelcomeEmailService" as Email
end box

box "Seller Service" #LightGreen
    participant "SellerStateEntityService" as SellerSvc
    database "Database" as DB
end box

== Initialization ==
Client -> API: POST /api/admin/sellers\n(CreateSellerCommand + Bank Details)
API -> Orch: Execute Flow (seller-orchestration)

== Step 1: Validation ==
Orch -> Validate: execute(context)
Validate -> Validate: Check Business Name\nCheck Email Uniqueness
Validate --> Orch: Validated

== Step 2: Creation & Mapping ==
Orch -> Create: execute(context)
note right of Create
    Maps Command to Seller Entity
    Maps Bank Details -> PaymentMethodd
    (Status: PENDING_VERIFICATION)
end note
Create -> SellerSvc: create(Seller)
SellerSvc -> DB: INSERT Seller, PaymentInfo
DB --> SellerSvc: ID Generated
SellerSvc --> Create: Created Seller (DRAFT)

Create -> SellerSvc: processById(id, "submitApplication")
SellerSvc -> DB: UPDATE State -> PENDING_VERIFICATION
SellerSvc --> Create: Transition Complete
Create --> Orch: Seller Created

== Step 3: KYC Verification ==
Orch -> KYC: execute(context)
KYC -> KYC: Verify Documents (Mock/Real)
KYC --> Orch: Verified

== Step 4: Parallel Actions ==
par Parallel Execution
    Orch -> Email: execute(context)
    Email -> Email: Send Welcome Email
    Email --> Orch: Sent
else Future: Bank Verification
    note right of Orch
        (Previously setup-bank-account-service)
        Now handled via async process
        or separate verification flow
    end note
end

== Completion ==
Orch --> API: Success (200 OK)
API --> Client: Seller Created Response

@enduml
