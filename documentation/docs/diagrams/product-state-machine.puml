@startuml Product State Machine

skinparam backgroundColor #FEFEFE
skinparam state {
    BackgroundColor<<Draft>> LightYellow
    BackgroundColor<<Review>> LightBlue
    BackgroundColor<<Active>> LightGreen
    BackgroundColor<<Rejected>> LightCoral
}

[*] --> DRAFT : Seller creates product

state DRAFT <<Draft>> {
    DRAFT : Seller editing product
    DRAFT : Adding variants
    DRAFT : Setting inventory
}

DRAFT --> PENDING_REVIEW : Submit for review
note on link: ValidateComplianceCommand\nSubmitForReviewCommand

state PENDING_REVIEW <<Review>> {
    PENDING_REVIEW : In review queue
    PENDING_REVIEW : Admin reviewing
}

PENDING_REVIEW --> NEEDS_REVISION : Request changes
note on link: ReviewProductCommand\n(needs changes)

PENDING_REVIEW --> APPROVED : Approve
note on link: ReviewProductCommand\n(approved)

PENDING_REVIEW --> REJECTED : Reject
note on link: ReviewProductCommand\n(rejected)

state NEEDS_REVISION <<Review>> {
    NEEDS_REVISION : Waiting for seller
    NEEDS_REVISION : Feedback provided
}

NEEDS_REVISION --> DRAFT : Seller makes changes
note on link: Seller updates product

state APPROVED <<Active>> {
    APPROVED : Ready to publish
}

APPROVED --> ACTIVE : Publish
note on link: PublishProductCommand

state ACTIVE <<Active>> {
    ACTIVE : Live on platform
    ACTIVE : Visible to customers
    ACTIVE : Available for purchase
}

ACTIVE --> INACTIVE : Deactivate
note on link: Seller/Admin action

ACTIVE --> OUT_OF_STOCK : No inventory
note on link: Inventory depleted

state INACTIVE {
    INACTIVE : Temporarily disabled
    INACTIVE : Not visible
}

INACTIVE --> ACTIVE : Reactivate
note on link: Seller/Admin action

state OUT_OF_STOCK {
    OUT_OF_STOCK : No stock available
    OUT_OF_STOCK : Not purchasable
}

OUT_OF_STOCK --> ACTIVE : Restock
note on link: Inventory added

state REJECTED <<Rejected>> {
    REJECTED : Not approved
    REJECTED : Cannot be published
}

REJECTED --> [*] : Delete

@enduml
