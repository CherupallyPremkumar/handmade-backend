@startuml payment-management-architecture
!theme plain
title Payment Management - Microservice Architecture

package "Payment Management System" {

    component [Orchestrator Service] as Orchestrator
    
    package "Core Payment" {
        component [Payment Service] as Payment
        component [Payment API] as PaymentAPI
    }

    package "Financial Core" {
        component [Wallet Service] as Wallet
        component [Ledger Service] as Ledger
        component [Reconciliation Service] as Reconciliation
    }

    package "PSP Adapters" {
        component [Razorpay Service] as Razorpay
        component [Stripe Service] as Stripe
        component [Cash Service] as Cash
    }

    package "Tax & Compliance" {
        component [Tax Service] as Tax
        component [GSTIN Validator] as GSTIN
        component [EIN Validator] as EIN
    }
}

' Relationships
Orchestrator --> Payment : Orchestrates
Orchestrator --> Tax : Orchestrates

Payment --> Razorpay : Uses (Strategy)
Payment --> Stripe : Uses (Strategy)
Payment --> Cash : Uses (Strategy)
Payment --> Wallet : Credits/Debits
Payment --> Ledger : Records Transactions

Tax --> GSTIN : Validates (IN)
Tax --> EIN : Validates (US)

Reconciliation --> Payment : Verifies
Reconciliation --> Ledger : Verifies
Reconciliation --> Razorpay : Fetches Settlement
Reconciliation --> Stripe : Fetches Settlement

@enduml
