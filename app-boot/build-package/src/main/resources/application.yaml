# Base Application Configuration
# All values use environment variables - set via profile-specific files or system env

spring:
  application:
    name: ${APP_NAME}
  
  # Database Configuration (provided by profile)
  datasource:
    url: ${DB_URL}
    driver-class-name: ${DB_DRIVER}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    
    hikari:
      maximum-pool-size: ${HIKARI_MAX_POOL_SIZE:5}
      minimum-idle: ${HIKARI_MIN_IDLE:1}
      idle-timeout: ${HIKARI_IDLE_TIMEOUT:30000}
      connection-timeout: ${HIKARI_CONNECTION_TIMEOUT:30000}
      max-lifetime: ${HIKARI_MAX_LIFETIME:1800000}
  
  # H2 Console (only for dev profile)
  h2:
    console:
      enabled: ${H2_CONSOLE_ENABLED:false}
      path: ${H2_CONSOLE_PATH:/h2-console}
  
  # JPA/Hibernate Configuration
  jpa:
    database-platform: ${JPA_DATABASE_PLATFORM}
    hibernate:
      ddl-auto: ${JPA_DDL_AUTO}
    show-sql: ${JPA_SHOW_SQL:false}
    properties:
      hibernate:
        format_sql: ${HIBERNATE_FORMAT_SQL:true}
        use_sql_comments: ${HIBERNATE_USE_SQL_COMMENTS:true}
        default_schema: ${HIBERNATE_DEFAULT_SCHEMA:public}
  
  # Allow bean definition overriding (for Chenile framework)
  main:
    allow-bean-definition-overriding: ${ALLOW_BEAN_OVERRIDE:true}

# Server Configuration
server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: ${CONTEXT_PATH:/api}

# Actuator Endpoints
management:
  endpoints:
    web:
      exposure:
        include: ${ACTUATOR_ENDPOINTS:health,info,metrics}
  endpoint:
    health:
      show-details: ${HEALTH_DETAILS:always}

# Logging Configuration
logging:
  level:
    root: ${LOG_LEVEL_ROOT:INFO}
    com.handmade.ecommerce: ${LOG_LEVEL_APP:INFO}
    org.hibernate.SQL: ${LOG_LEVEL_SQL:WARN}
    org.hibernate.type.descriptor.sql.BasicBinder: ${LOG_LEVEL_SQL_BINDER:WARN}
    org.springframework.web: ${LOG_LEVEL_WEB:INFO}
  pattern:
    console: "${LOG_PATTERN:%d{yyyy-MM-dd HH:mm:ss} - %msg%n}"

# Chenile Security (Keycloak integration)
chenile:
  security:
    keycloak:
      host: ${KEYCLOAK_HOST}
      port: ${KEYCLOAK_PORT:8080}
      base:
        realm: ${KEYCLOAK_REALM}
    client:
      id: ${KEYCLOAK_CLIENT_ID}
      secret: ${KEYCLOAK_CLIENT_SECRET}
    login:
      success-url: ${LOGIN_SUCCESS_URL:/}
      failure-url: ${LOGIN_FAILURE_URL:/login?error}
    ignore: ${SECURITY_IGNORE:false}