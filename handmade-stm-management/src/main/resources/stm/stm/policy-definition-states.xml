<?xml version="1.0" encoding="UTF-8"?>
<!--
Standard E-commerce PolicyDefinition State Machine
Purpose: Manage lifecycle of platform policies (refund, return, compliance, etc.).
Flow: POLICY_DEFINITION_FLOW
Lifecycle: DRAFT -> REVIEW -> ACTIVE -> DEPRECATED
-->
<states>
    <event-information eventId="createPolicy"  eventName="Create policy"  meta-acls="policy.admin"/>
    <event-information eventId="submitReview"  eventName="Submit for review" meta-acls="policy.admin"/>
    <event-information eventId="approvePolicy" eventName="Approve policy" meta-acls="policy.governance"/>
    <event-information eventId="rejectPolicy"  eventName="Reject policy"  meta-acls="policy.governance"/>
    <event-information eventId="activatePolicy" eventName="Activate policy" meta-acls="policy.governance"/>
    <event-information eventId="deprecatePolicy" eventName="Deprecate policy" meta-acls="policy.governance"/>

    <flow id="POLICY_DEFINITION_FLOW" default="true">
        <manual-state id="DRAFT" initialState="true">
            <on eventId="submitReview" newStateId="REVIEW" componentName="policySubmitForReviewAction"/>
        </manual-state>

        <manual-state id="REVIEW">
            <on eventId="approvePolicy" newStateId="READY_FOR_ACTIVATION" componentName="policyApproveAction"/>
            <on eventId="rejectPolicy"  newStateId="REJECTED"            componentName="policyRejectAction"/>
        </manual-state>

        <manual-state id="READY_FOR_ACTIVATION">
            <on eventId="activatePolicy" newStateId="ACTIVE" componentName="policyActivateAction"/>
        </manual-state>

        <manual-state id="ACTIVE">
            <on eventId="deprecatePolicy" newStateId="DEPRECATED" componentName="policyDeprecateAction"/>
        </manual-state>

        <manual-state id="REJECTED"    meta-endState="true"/>
        <manual-state id="DEPRECATED"  meta-endState="true"/>
    </flow>
</states>
