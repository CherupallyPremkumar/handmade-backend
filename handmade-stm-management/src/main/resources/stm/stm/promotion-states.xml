<?xml version="1.0" encoding="UTF-8"?>
<!--
Standard E-commerce Promotion State Machine
Purpose: Manage lifecycle of platform or seller-funded promotions.
Flow: PROMOTION_FLOW
Lifecycle: DRAFT -> SCHEDULED -> ACTIVE -> PAUSED -> EXPIRED / CANCELLED
-->
<states>
    <event-information eventId="createPromotion"  eventName="Create promotion"  meta-acls="promo.ops"/>
    <event-information eventId="schedulePromotion" eventName="Schedule promotion" meta-acls="promo.ops"/>
    <event-information eventId="activatePromotion" eventName="Activate promotion" meta-acls="promo.ops"/>
    <event-information eventId="pausePromotion"    eventName="Pause promotion"    meta-acls="promo.ops"/>
    <event-information eventId="resumePromotion"   eventName="Resume promotion"   meta-acls="promo.ops"/>
    <event-information eventId="expirePromotion"   eventName="Expire promotion"   meta-acls="promo.ops"/>
    <event-information eventId="cancelPromotion"   eventName="Cancel promotion"   meta-acls="promo.ops"/>

    <flow id="PROMOTION_FLOW" default="true">
        <manual-state id="DRAFT" initialState="true">
            <on eventId="schedulePromotion" newStateId="SCHEDULED" componentName="promotionScheduleAction"/>
            <on eventId="cancelPromotion"   newStateId="CANCELLED" componentName="promotionCancelAction"/>
        </manual-state>

        <manual-state id="SCHEDULED">
            <on eventId="activatePromotion" newStateId="ACTIVE" componentName="promotionActivateAction"/>
            <on eventId="cancelPromotion"   newStateId="CANCELLED" componentName="promotionCancelAction"/>
        </manual-state>

        <manual-state id="ACTIVE">
            <on eventId="pausePromotion"  newStateId="PAUSED"   componentName="promotionPauseAction"/>
            <on eventId="expirePromotion" newStateId="EXPIRED"  componentName="promotionExpireAction"/>
            <on eventId="cancelPromotion" newStateId="CANCELLED" componentName="promotionCancelAction"/>
        </manual-state>

        <manual-state id="PAUSED">
            <on eventId="resumePromotion" newStateId="ACTIVE"   componentName="promotionResumeAction"/>
            <on eventId="expirePromotion" newStateId="EXPIRED"  componentName="promotionExpireAction"/>
            <on eventId="cancelPromotion" newStateId="CANCELLED" componentName="promotionCancelAction"/>
        </manual-state>

        <manual-state id="EXPIRED"   meta-endState="true"/>
        <manual-state id="CANCELLED" meta-endState="true"/>
    </flow>
</states>
